{#
/**
 * @file
 * Diagnostic template to debug preview server
 */
#}

<div{{ attributes.addClass('subsite-agenda') }}>

  <h2>Diagnostic Information</h2>
  
  <div style="background: #f0f0f0; padding: 20px; margin: 20px 0;">
    <h3>Environment Check:</h3>
    <p><strong>Server:</strong> {{ app.request.server.get('SERVER_NAME') }}</p>
    <p><strong>Environment:</strong> {{ app.request.server.get('APP_ENV') ?? 'Unknown' }}</p>
  </div>

  <div style="background: #fff3cd; padding: 20px; margin: 20px 0;">
    <h3>Content Variable Check:</h3>
    <p><strong>content exists:</strong> {{ content is defined ? 'YES' : 'NO' }}</p>
    <p><strong>content is empty:</strong> {{ content is empty ? 'YES' : 'NO' }}</p>
    
    <h4>Available fields in content:</h4>
    <ul>
      {% for key in content|keys %}
        <li>{{ key }}</li>
      {% endfor %}
    </ul>
  </div>

  <div style="background: #d1ecf1; padding: 20px; margin: 20px 0;">
    <h3>Field Check: field_subsite_daily_schedule</h3>
    <p><strong>Field exists:</strong> {{ content.field_subsite_daily_schedule is defined ? 'YES' : 'NO' }}</p>
    <p><strong>Field is empty:</strong> {{ content.field_subsite_daily_schedule is empty ? 'YES' : 'NO' }}</p>
    
    {% if content.field_subsite_daily_schedule is defined %}
      <h4>Field Structure:</h4>
      <pre style="background: white; padding: 10px; overflow: auto;">{{ dump(content.field_subsite_daily_schedule) }}</pre>
      
      <p><strong>Has #items:</strong> {{ content.field_subsite_daily_schedule['#items'] is defined ? 'YES' : 'NO' }}</p>
      
      {% if content.field_subsite_daily_schedule['#items'] is defined %}
        <p><strong>#items is empty:</strong> {{ content.field_subsite_daily_schedule['#items'] is empty ? 'YES' : 'NO' }}</p>
        <p><strong>#items count:</strong> {{ content.field_subsite_daily_schedule['#items']|length }}</p>
      {% endif %}
    {% endif %}
  </div>

  <div style="background: #d4edda; padding: 20px; margin: 20px 0;">
    <h3>Alternative Field Names to Check:</h3>
    <p><strong>field_daily_schedule exists:</strong> {{ content.field_daily_schedule is defined ? 'YES' : 'NO' }}</p>
    {% if content.field_daily_schedule is defined %}
      <p><strong>field_daily_schedule has #items:</strong> {{ content.field_daily_schedule['#items'] is defined ? 'YES' : 'NO' }}</p>
      {% if content.field_daily_schedule['#items'] is defined %}
        <p><strong>field_daily_schedule #items count:</strong> {{ content.field_daily_schedule['#items']|length }}</p>
      {% endif %}
    {% endif %}
  </div>

  <div style="background: #f8d7da; padding: 20px; margin: 20px 0;">
    <h3>Config Pages Object Check:</h3>
    <p><strong>config_pages exists:</strong> {{ config_pages is defined ? 'YES' : 'NO' }}</p>
    {% if config_pages is defined %}
      <p><strong>config_pages type:</strong> {{ config_pages.getEntityTypeId() }}</p>
      <p><strong>config_pages bundle:</strong> {{ config_pages.bundle() }}</p>
      
      <h4>Config Pages Fields:</h4>
      <ul>
        {% for field_name, field in config_pages.getFields() %}
          <li>{{ field_name }} - {{ field.isEmpty() ? 'EMPTY' : 'HAS DATA' }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <hr>

  <h2>Original Template Logic Test:</h2>
  {% if content.field_subsite_daily_schedule['#items'] is not empty %}
    <p style="color: green; font-weight: bold;">✓ Condition PASSED - Schedule should display</p>
    <p>Items count: {{ content.field_subsite_daily_schedule['#items']|length }}</p>
  {% else %}
    <p style="color: red; font-weight: bold;">✗ Condition FAILED - No schedule will display</p>
    <p>Reason: field_subsite_daily_schedule['#items'] is empty or doesn't exist</p>
  {% endif %}

</div>
